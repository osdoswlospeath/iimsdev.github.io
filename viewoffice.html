<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IIMS | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ */
    @media print {
      #header-placeholder, .nav, .btn, .footer { display: none !important; }
      .container { max-width: 100%; margin: 0; padding: 0; }
      .card { border: none; box-shadow: none; padding: 0; }
      .print-only { display: block !important; }
      .screen-only { display: none !important; }
      
      table.print-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      table.print-table th, table.print-table td {
        border: 1px solid #000;
        padding: 8px;
        text-align: left;
      }
    }
    .print-only { display: none; }
    .data-row { display: flex; border-bottom: 1px solid var(--border); padding: 10px 0; }
    .data-label { font-weight: bold; width: 150px; color: var(--purple); }
    .data-value { flex: 1; }
  </style>
</head>
<body>
  <div id="header-placeholder"></div>

  <div class="container">
    <div class="card">
      <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--purple); padding-bottom: 10px; margin-bottom: 20px;">
        <h2 style="margin:0;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
        <button onclick="window.print()" class="btn primary screen-only">üñ®Ô∏è ‡∏™‡∏±‡πà‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
      </div>

      <div id="officeDetail" class="screen-only">
        <div class="data-row"><div class="data-label">‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</div><div id="d-iden" class="data-value">‚Äî</div></div>
        <div class="data-row"><div class="data-label">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</div><div id="d-name" class="data-value">‚Äî</div></div>
        <div class="data-row"><div class="data-label">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</div><div id="d-addr" class="data-value">‚Äî</div></div>
        <div class="data-row"><div class="data-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</div><div id="d-stat" class="data-value">‚Äî</div></div>
        <div class="data-row"><div class="data-label">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</div><div id="d-user" class="data-value">‚Äî</div></div>
        <div class="data-row"><div class="data-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</div><div id="d-tele" class="data-value">‚Äî</div></div>
        <div class="data-row"><div class="data-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:</div><div id="d-date" class="data-value">‚Äî</div></div>
      </div>

      <div class="print-only">
        <center>
          <h3>‡πÅ‡∏ö‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
          <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢ (IIMS)</p>
        </center>
        <table class="print-table">
          <tr><th>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th><th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th></tr>
          <tr><td>‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</td><td id="p-iden"></td></tr>
          <tr><td>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</td><td id="p-name"></td></tr>
          <tr><td>‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</td><td id="p-addr"></td></tr>
          <tr><td>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</td><td id="p-user"></td></tr>
          <tr><td>‡πÄ‡∏öers‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</td><td id="p-tele"></td></tr>
          <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</td><td id="p-date"></td></tr>
        </table>
        <p style="margin-top: 50px; text-align: right;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠..........................................................‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</p>
      </div>
    </div>
    
    <div style="text-align: center; margin-top: 20px;">
        <a href="huboffice.html" class="btn screen-only">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</a>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    // ‡∏î‡∏∂‡∏á‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏≠‡∏î‡∏µ‡∏à‡∏≤‡∏Å URL ‡πÄ‡∏ä‡πà‡∏ô viewoffice.html?id=1001
    const urlParams = new URLSearchParams(window.location.search);
    const officeId = urlParams.get('id');

    window.onload = async function() {
      if (!officeId) {
        alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô");
        return;
      }
      
      // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á action ‡πÉ‡∏ô GAS ‡πÉ‡∏´‡πâ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡πá‡πÑ‡∏î‡πâ)
      try {
        const API_URL = "https://script.google.com/macros/s/AKfycbz8zohztNMZnGpYzQ-vSL6Uj6AZKP9npCsOUC3zSAYJnzkB3yy1OKar2yasMxGmVv_G/exec?action=getAllOffices";
        const response = await fetch(API_URL);
        const allData = await response.json();
        
        const office = allData.find(o => String(o.bran_iden) === officeId);
        
        if (office) {
          // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
          document.getElementById('d-iden').innerText = office.bran_iden;
          document.getElementById('d-name').innerText = office.bran_name;
          document.getElementById('d-addr').innerText = office.bran_addr;
          document.getElementById('d-stat').innerText = office.bran_iden_stat === 'ac' ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥' : '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å';
          document.getElementById('d-user').innerText = office.crea_user;
          document.getElementById('d-tele').innerText = office.crea_tele;
          document.getElementById('d-date').innerText = office.crea_date;

          // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå
          document.getElementById('p-iden').innerText = office.bran_iden;
          document.getElementById('p-name').innerText = office.bran_name;
          document.getElementById('p-addr').innerText = office.bran_addr;
          document.getElementById('p-user').innerText = office.crea_user;
          document.getElementById('p-tele').innerText = office.crea_tele;
          document.getElementById('p-date').innerText = office.crea_date;
        }
      } catch (e) {
        console.error("Fetch error:", e);
      }
    };
  </script>
</body>
</html>
